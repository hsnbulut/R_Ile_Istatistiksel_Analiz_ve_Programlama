---
title: "ggplot2 paketi"
author: "Doç. Dr. Hasan BULUT"
output: 
  pdf_document: default
  html_notebook:
    toc: yes
    number_sections: yes
  word_document:
    toc: yes
  html_document:
    toc: yes
    number_sections: yes
    df_print: tibble
---

**Ekonomik Göstergeler verisi (ecodata):** MSMwRA paketindeki bu veri ülkemizdeki 81 ilin bazı ekonomik göstergelerini içermektedir. Verinin genel yapısı aşağıdaki gibi görülebilir.

```{r}
library(MSMwRA)
str(ecodata)
```

**İris Verisi:** 3 farklı çiçek türünün 4 değişken bakımından aldığı değerleri gösteren bu veri seti R programında `datasets` paketinde hazır olarak gelmektedir. Genel yapısı aşağıdaki gibidir.

```{r}
str(iris)
```

**Basınç Verisi:** Yine datasets paketinde hazır olarak gelen bu veri basınç ve sıcaklık değişkenlerinden oluşmaktadır. Genel yapısı aşağıdaki gibidir.

```{r}
str(pressure)
```

**melanoma verisi:** boot paketinde bulunan bu veri seti insanların tümör kalınlığı, yaş, cinsiyet, yaşam statüsü gibi değişkenlerden oluşmaktadır.

```{r}
library(boot)
data(melanoma)
str(melanoma)
```

Burada gerçekte kategorik olan status, sex ve ulcer değişkenleri aşağıdaki gibi factor veri tipine dönüştürülebilir.

```{r}
melanoma$status<-factor(melanoma$status,levels=c(2,1,3),
                           labels=c("Alive","Melanoma death",
                                    "Non-melanoma death"))
melanoma$sex<-factor(melanoma$sex,
                        labels=c("female","male"))
melanoma$ulcer<-factor(melanoma$ulcer,
                          labels=c("absent","present"))
str(melanoma)
```

Artık bu verileri kullanarak farklı amaçlar için kullanılabilecek grafikleri, bunların nasıl elde edilebileceğini inceleyelim.

# Çubuk (Sütun, Bar) Grafiği

Kategorik bir değişkenin frekanslarının görselleştirilmesi amacıyla çubuk garfiklerinden yararlanılmaktadır.

ggplot2 paketinde genel olarak iki farklı fonksiyon vardır. Birincisi `qplot()` fonksiyonudur. Fonksiyonun genel yapısı aşağıdaki gibidir.

$$qplot(x, y = NULL, data, geom="auto")$$ Burada `x` ve `y` argümanları birer değişken alırken, tek bir değişken üzerinde çalışılmak istendiğinde `y` argümanı default olarak `NULL` tanımlandığından kullanılmayabilir. Bu argümanlara sadece değişken isimleri girilir. `data` argümanına isimleri `x` ve `y` argümanına girilen değişkenlerin çekileceği veri seti (`data.frame` olmalı) girilir. Eğer `x` ve `y` argümanına değişken isimleri yerine doğrudan değişken vektörleri girilmişse, `data` argümanı kullanılmayabilir. `geom` argümanı ise grafiğin türünü ve şeklini belirlemek için kullanılır. Bu bölümde temel grafiklerin `qplot()` fonksiyonuyla elde edilmesini ele alacağız.

Şimdi melanoma verisindeki status değişkeni için sütun grafiği oluşturalım.

```{r}
library(ggplot2)
qplot(data=melanoma,
      x=status,
      geom="bar",
      main ="Melanoma İçin Sütun Grafiği",
      xlab = "Hasta Durumları",
      ylab="Frekanslar")
```

`ggplot2` paketinde bulunan bir diğer fonksiyon yapısı ise `ggplot()` fonksiyonudur. Bu fonksiyon sayısız kombinasyonun bir araya getirilmesiyle oluşturulabilen bir yapıya sahiptir ve bu esneklikten dolayı daha sık kullanılır.

Buna göre aynı grafik `ggplot()` fonksiyonuyla aşağıdaki gibi oluşturulabilir.

```{r}
ggplot(data=melanoma,mapping = aes(x=status))+
  geom_bar()+
  labs(title = "Melanoma İçin Sütun Grafiği",
       subtitle = "Alt başlık",
       caption = "Hasan BULUT",
       x="Hasta Durumu",y="Frekans")
```

Burada dikkat edilirse öncelikle `ggplot()` fonksiyonuyla kullanılacak veri tanıtıldı, mapping argümanına `aes` fonksiyonu yardımıyla bu verideki hangi değişkenin kullanılacağı ifade edildi ve daha sonra fonksiyon kapatılarak grafiğin yazdırılacağı bir kanvas oluşturdu. Daha sonra bu kanvas üzerine grafiğin eklenmesi amacıyla `+` operatörü kullanıldı ve bu operatörden sonra `geom_bar()` yazarak, bu grafik üzerine çubuk grafiği eklendi.

Şimdi grafiği `geom_bar` fonksiyonunda bu çubukları renklerle doldurabiliriz. `color` argümanı kutunun dışını, `fill`argümanı ise içini renklendirmektedir.

```{r}
ggplot(data=melanoma,aes(x=status))+
  geom_bar(fill=c("darkgreen","darkred","darkblue"))+
  labs(title="Sütun Grafiği",
       subtitle = "Alt başlık",
       x="X ekseni",
       y="Y ekseni",
       caption = "Doç. Dr. Hasan BULUT")
```

Grafiğin üzerinde frekans ve yüzde bilgileri aşağıdaki gibi girilebilir. Öncelikle yukarıda oluşturulan grafiği plt1 isminde bir nesneye aktaralım. Ayrıca frekansları ve yüzdeleri de aşağıdaki gibi hesaplayalım.

```{r}
plt1<-ggplot(data=melanoma,aes(x=status))+
  geom_bar(fill=c("darkgreen","darkred","darkblue"))+
  labs(title="Sütun Grafiği",
       subtitle = "Alt başlık",
       x="X ekseni",
       y="Y ekseni",
       caption = "Doç. Dr. Hasan BULUT")

f.status<-table(melanoma$status)
yüzde.status<-f.status/sum(f.status)*100
kategoriler<-names(f.status)
```

Şimdi bu bilgileri grafikteki sütunların üzerine annotate() fonksiyonuyla aşağıdaki gibi ekleyebiliriz.

```{r}
plt1+annotate(geom = "text", x = levels(melanoma$status),
           y = f.status + 30,
label = paste(kategoriler, "\n",
                          "n=", f.status, "\n",
                          "%", round(yüzde.status,2)), 
size = 3)
```

# Pasta (Pie) Grafiği

Kategorik verilerin görselleştirilmesinde en popüler grafik türü şüphesiz pasta (pie) grafiğidir.

Pasta grafiğini `ggplot()` fonksiyonuyla elde etmek için öncelikle çubuk grafiği `geom_bar()` ile oluşturulur ve daha sonra `coord_polar()` fonksiyonuyla bu grafik pastaya dönüştürülür. Bu yapı aslında `ggplot2` paketinin kullanımını çok güzel özetlemektedir.

```{r}
library(ggplot2)
ggplot(melanoma,aes(x="",fill=factor(status)))+
  geom_bar()+
  coord_polar(theta = "y",start = 0)+
  labs(title="Hasta Durumları İçin Pasta Grafiği")
```

Burada `labs` fonksiyonuyla sağdaki legend'in başlığı değiştirilebilir.

```{r}
ggplot(melanoma,aes(x="",fill=factor(status)))+
  geom_bar()+
  coord_polar(theta = "y",start = 0)+
  labs(title="Hasta Durumları İçin Pasta Grafiği",
       fill="Hasta Durumu")
```

Burada grafiği sadeleştirmek ve gereksiz yazıları silmek istediğimizde theme_void() fonksiyonu kullanılabilir.

```{r}
ggplot(melanoma,aes(x="",fill=factor(status)))+
  geom_bar()+
  coord_polar(theta = "y",start = 0)+
  labs(title="Hasta Durumları İçin Pasta Grafiği",
       fill="Hasta Durumu")+
  theme_void()
```

# Histogram

Histogram grafiği sürekli değişkenin eşit genişlikteki değer aralıklarına karılık gelen frekansların hizasında olacak şekilde oluşturulan dikdörtgenlerin yan yana getirilmesiyle oluşturulur. Bu grafik çubuk grafiğine benzemektedir. Çubuk garfiğinde çubuklar arasında boşluklar bulunurken, histogramdaki çubuklar arasında boşluk bulunmamaktadır. Histogram grafiği veri setinin normal, sağa çarpık ya da sola çarpık olma durumu gibi bilgilerin görülmesini sağlamaktadır.

`qplot()` fonksiyonuyla histogram grafiği çizmek için `geom="histogram"` argümanı seçilir. Buna göre `iris` verisindeki Sepal.Width değişkenin histogram grafiği aşağıdaki gibi elde edilir. Burada tek değişkene ihtiyaç olduğundan `y` argümanına herhangi bir değer girilmemektedir.

```{r}
library(ggplot2)
qplot(data=melanoma,x=thickness,geom="histogram")
```

Burada değer aralığını 30'a böldüğünü ve bu sayıyı değiştirerek daha iyi bir görüntü elde edilebileceği söyleniyor. Bu sayıyı değiştirmek için `bins` argümanı kullanılır.

```{r}
qplot(data=melanoma,x=thickness,
      geom="histogram",bins=20)
```

ggplot() fonksiyonuyla ise bu grafik aşağıdaki gibi elde edilebilir.

```{r}
a<-ggplot(data=melanoma,mapping=aes(x=thickness))
a+geom_histogram(bins = 20)
```

Burada geom_histogram fonksiyonu içerisine fill argümanıyla dikdörtgenlerin içi doldurulabilir, col argümanıyla çizgiler renklendirilebilir, size ile çizgilerin kalınlığı ve bins ile dikdörtegen sayısı belirlenebilir.

```{r}
b<-a+geom_histogram(fill="red",bins=20,
                 col="blue",size=0.5)
b
```

Ayrıca `labs()` fonksiyonuyla aşağıdaki gibi başlıklar eklenebilir. Burada ana başlık için title, alt başlık için subtitle, x ve y eksenleri için de x ve y argümanları kullanılır.

```{r}
b+labs(title="Thickness",
       subtitle="Melanoma verisindeki kalınlık değerleri için histogram grafiği",
       x="Thickness Değerleri")
```

Ayrıca bu grafiği status değişkenine göre inceleyebiliriz. Bunun için geom_histogram içerisinde `aes(fill=status)` ifadesini kodun içerisine eklememiz yeterlidir. Ancak bu durumda `geom_histogram()` içerisindeki `fill="red"` ifadesini silmeliyiz. Aksi takdirde türleri değil tüm dikdörtgenleri yine kırmızıyla doldurur.

```{r}
a+geom_histogram(aes(fill=status),bins=20,
                 col="black",size=0.7)+
  labs(title="Hasta Durumuna Göre Kalınlık",
      subtitle="Hasta durumuna göre kalınlık değerlerinin histogram grafikleri",
      x="Thickness")
```

# Yoğunluk Grafikleri

Yoğunluk grafikleri özellikle verinin normal dağılıp-dağılmadığını anlamak için kullanılan bir araçtır. Yoğunluk grafiği için `geom_density()` fonksiyonu kullanılır. Burada eğrinin altını maviyle doldurduk ancak alpha=0.4 diyerek bu rengi saydamlaştırdık. Bu değer 0 ile 1 arasında değer alır ve sıfıra yaklaştıkça renk saydamlaşır.

```{r}
a+geom_density(fill="darkred")
```

Daha önce yaptığımız gibi şimdi de kalınlık değişkenin yoğunluk grafiğini üç farklı hasta durumu için aşağıdaki gibi üst üste görselleştirebiliriz. Burada yapılacak işlem `geom_density()` fonksiyonu içerisinde `aes(fill=status)` yapısını eklemektir.

```{r}
a+geom_density(aes(fill=status),alpha=0.5)
```

Burada yeri gelmişken SCI indeksinde taranan dergilerde kullanılan renk yapılarından oluşan bir paket bulunmaktadır. `ggsci` ismindeki bu paket ile ilgili bir vignette aşağıdaki linkten ulaşılabilir.

<https://cran.r-project.org/web/packages/ggsci/vignettes/ggsci.html>

Bunun için buradaki `D3` renk skalasını renk seçimi olarak yukarıdaki yoğunluk grafiğini veren koda `+scale_fill_d3()` eklememiz yeterlidir.

```{r}
library(ggsci)
a+geom_density(aes(fill=status),alpha=0.5)+
  scale_fill_d3()
```

## Boxplot (Kutu) Grafikleri

Boxplot grafiği aşağıda görülebileceği gibi aynı anda çok sayıda bilgiyi okuyucuya sunabilmektedir. Aşağıdaki örnekte görüldüğü üzere boxplot grafiği aykırı değerleri (varsa), minimum, maksimum, 1., 2. (medyan) ve 3. çeyrek değerlerini ifade etmektedir.

![](boxplot%20kopyas%C4%B1.png)

`qplot()` fonksiyonuyla boxplot grafiği çizmek için `geom="boxplot"` argümanı seçilir. Buna göre `melanoma` verisindeki kalınlık değişkenin boxplot grafiği aşağıdaki gibi elde edilir. Burada tek değişkene ihtiyaç olduğundan `y` argümanına herhangi bir değer girilmemektedir.

```{r}
qplot(data=melanoma,x=thickness,geom="boxplot")
```

Aynı değişkenin farklı durumlara göre boxplot grafiklerini çizmek için `y` argümanına ilgili faktör değişkeni girilebilir.

```{r}
qplot(data=melanoma,x=thickness,
      y=status,geom="boxplot")
```

Burada boxplot grafiklerini dikey yapmak için status değişkenini `x` argümanına (eksenine) ve `thickness` değişkenini de `y` argümanına (eksenine) yerleştirmek yeterlidir.

```{r}
qplot(data=melanoma,y=thickness,x=status,
      geom="boxplot")
```

Bu kutuların içerisini status değişkenine göre farklılaşan renklerle doldurabiliriz.

```{r}
qplot(data=melanoma,y=thickness,x=status,
      geom="boxplot",fill=status)
```

Şimdi bu grafikleri `ggplot()` fonksiyonuyla elde etmeye çalışalım. Bunun için `geom_boxplot()` fonksiyonu kullanılır.

```{r}
c<-ggplot(data=melanoma,aes(x=thickness))
c
```

Şimdi c kanvasına ilgili boxplot grafiklerini ekleyebiliriz.

```{r}
c+geom_boxplot()
```

qplot() fonksiyonuyla yapıldığı gibi status değişkenine göre farklı boxplotlar çizilebilir.

```{r}
ggplot(data=melanoma,aes(x=status, y=thickness))+
  geom_boxplot()
```

Son olarak burada yine ggsci paketindeki renk seçeneklerinden birisi kullanılabilir.

```{r}
ggplot(data=melanoma,aes(x=status, y=thickness))+
  geom_boxplot(aes(fill=status))+
  scale_fill_d3()
```

## Keman (Violin) Grafikleri

Bu grafikler de aslında gruplanmış `boxplot()` grafiklerine benzemekte olup, farklı olarak gözlemlerin görülme sıklıklarına göre yoğunluklarını da görselleştirerek kuru yerine kemana benzeyen bir görüntü ortaya çıkarmaktadırlar. Burada ggplot() fonksiyonuyla violin grafiği gösterilecektir.

```{r}
d<-ggplot(data=melanoma,aes(x=status,y=thickness))
d+geom_violin()
```

İlgili kemanları hasta durumlarına göre aşağıdaki gibi renklendirebiliriz.

```{r}
d+geom_violin(aes(fill=status))+
  scale_fill_d3()
```

# Saçılım Grafiği

İki sayısal değişkenin birlikte değişimlerinin ve aralarındaki ilişki yapısının incelenmesi amacıyla kullanılan grafik türüdür. Genellikle trendi gözlemlemek için kullanılır.

pressure verisindeki sıcaklık ve basınç değişkenkeri için saçılım grafiğini oluşturunuz.

```{r}
library(ggplot2)
qplot(data=pressure,x=temperature,
      y=pressure,
      geom="point")
```

ggplot2 paketiyle saçılım grafiği oluşturmak için `geom_point()` fonksiyonu kullanılır. İlk yapı hiç değişmeyeceği için kolaylık olması bakımından ggplot() fonksiyonunu **a** nesnesine aktaralım.

```{r}
e<-ggplot(data=pressure,
          aes(x=temperature,y=pressure))
e
```

Artık oluşturduğumuz bu kanvas üzerine grafiği farklı şekillerde oluşturabiliriz.

```{r}
e+geom_point()
```

Burada noktalar üzerinde değişiklikler yapmak için geom_point() fonksiyonu kullanılabilir. Noktaların çevre rengi color, iç rengi fill, şekli size ve biçimi shape argüanlarıyla değiştirilir.

```{r}
e+geom_point(fill="red",shape=23,
             color="blue",size=2)
```

Şimdi de melanoma verisindeki yaş ve kalınlık değişkenlerinin saçılım grafiğini oluşturalım.

```{r}
ggplot(data=melanoma,aes(x=age,y=thickness))+
  geom_point(aes(col=status))
```

Burada ilave argüman ve fonksiyonlarla grafiği daha güçlü bir görsele kavuşturabiliriz. Buradaki shape değeri içi boyanabilir olan nokta türlerinden (21-25) olmalıdır.

```{r}
library(ggsci)
ggplot(data=melanoma,aes(x=age,y=thickness))+
  geom_point(aes(fill=status),shape=24,size=3)+
  scale_fill_d3()
```

# Köpük Grafiği (Bubble Plot)

İstersek farklı bir sayısal değişken bakımından noktaların aldıkları değerleri nokta büyüklükleri olarak tanımlayarak, bir köpük grafiği elde edebiliriz. Bir diğer ifadeyle köpük grafiği 3 sayısal değişkenin aynı anda görselleştirilebilmesine imkan vermektedir.

```{r}
ggplot(data=melanoma,aes(x=age,y=thickness))+
  geom_point(aes(size=time))
```

Hatta aynı anda bu noktaların içini de statüye göre renklendirebiliriz. Böylece dördüncü değişkeni de grafiğe eklemiş olacağız.

```{r}
ggplot(data=melanoma,aes(x=age,y=thickness))+
  geom_point(aes(size=time,col=status))
```

Şimdi de iris verisinin ilk 3 değişkeni için bir köpük grafiği oluşturalım. Bu grafikte çiçek türlerini de renklendirme aracı olarak kullanarak dördüncü değişkeni grafiğe eklemiş olalım.
```{r}
f<-ggplot(data=iris,aes(x=Sepal.Length,y=Petal.Length))+
  geom_point(aes(size=Sepal.Width,fill=Species),shape=21)
f
```
Grafiğe başlık eklemek ve eksenleri düzenlemek için aşağıdaki kodlar kullanılabilir. Burada labs fonksiyonu başlık eklemek için, scale_x_continuous() fonksiyonu x exseninin adını ve sınırlarını, scale_y_continuous() fonksiyonu ise y ekseninin adını ve sınırlarını belirlemek için kullanılır. scale_fill_d3() fonksiyonu otomatik renk seçimi yapar, ayrıca renklerin ifade edildiği etiketin başlığını name argümanıyla, renklerin saydamlığını da alpha argümanıyla belirler. Son olarak scale_size() fonksiyonu noktaların size değerinin belirleyen değişkenle ilgili düzenlemelerin yapılmasına izin verir ve burada sadece ilgili noktaların ismini name argümanıyla değiştirmiştir. 
```{r}
f <- f + 
  labs(title = "Turlerine gore Petal ve Sepal Uzunlukları") +
  scale_x_continuous(name = "Sepal Uzunluk", limits = c(4, 8.5)) +
  scale_y_continuous(name = "Petal Uzunluk", limits = c(0, 8))+
  scale_fill_d3(name = "Iris turleri", alpha = 0.5) +
  scale_size(name = "Sepal Genişlik")
f
```
Şimdi `MSMwRA` paketinde bulunan ecodata'yı aşağıdaki gibi aktive edelim.

```{r}
library(MSMwRA)
data(ecodata)
str(ecodata)
```

Bu verideki x1 ve x2 değişkeninin karşılıklı saçılım grafiğini elde edeceğiz. Noktaların büyüklüğünü x3 değişkenine göre belirleyeceğiz.

```{r}
ggplot(ecodata,aes(x=X1,y=X2))+
  geom_point(aes(size=X3))
```

Şimdi bu noktaların hangi illere ait olduğunu `geom_text()` fonksiyonuyla grafiğe ekleyelim.

```{r}
ggplot(ecodata,aes(x=X1,y=X2))+
  geom_point(aes(size=X3,alpha=0.3))+
  geom_text(aes(label=Cities),col="blue")
```

Değerler çok iç içe girdiği için geom_text() fonksiyonu içerisinde `check_overlap = TRUE` argümanı eklenebilir.

```{r}
ggplot(ecodata,aes(x=X1,y=X2))+
  geom_point(aes(size=X3,alpha=0.3))+
  geom_text(aes(label=Cities),col="blue",
            check_overlap = TRUE)
```

# Grafiklerin Kombine Edilmesi

ggplot2 paketinin en büyük avantajı farklı grafik türlerini aynı kanvas üzerinde üst üste kullanarak çok farklı grafikler ve görseller elde edilebilmesine olanak sağlamaktadır.

Örneğin hem boxplot hem de violin grafiği aşağıdaki gibi birleştirilebilir.

```{r}
ggplot(data=melanoma,aes(x=status,y=thickness))+
  geom_boxplot(aes(fill=status))+
  geom_violin(aes(fill=status))
```

Burada violin grafiğini daha sonra eklediğimiz için boxplot grafiğinin altta kaldığı görülmektedir. Ayrıca buraya gözlemleri ifade eden noktalar geom_point() fonksiyonuyla grafiğe eklenebilir.

```{r}
ggplot(data=melanoma,aes(x=status,y=thickness))+
  geom_boxplot(aes(fill=status))+
  geom_violin(aes(fill=status))+
  geom_point()
```

Burada aynı değere sahip gözlemlerin üst üste binmesinden dolayı küçük bir rassal hata eklenerek tüm gözlemlerin grafik üzerinde temsil edilmesi sağlanabilir. Bu amaçla geom_point() yerine geom_joint() fonksiyonu kullanılmalıdır.,

```{r}
ggplot(data=melanoma,aes(x=status,y=thickness))+
  geom_boxplot(aes(fill=status))+
  geom_violin(aes(fill=status))+
  geom_jitter()
```

Burada kalınlık değişkenini hasta durumuna göre görselleştirmiş olduk. Bu grafiğe cinsiyet değişkenini de eklemek istersek facet_grid() fonksiyonundan yararlanılabilir.

```{r}
ggplot(data=melanoma,aes(x=status,y=thickness))+
  geom_boxplot(aes(fill=status))+
  geom_violin(aes(fill=status))+
  geom_jitter()+
  facet_grid(~sex)
```

Hatta burada hasta durumuna göre kategorize etmeyi de aşağıdaki şekilde facet_grid() fonksiyonu içerisinde gerçekleştirerek daha ayrıntılı ve sade bir grafik elde edilebilir.

```{r}
ggplot(data=melanoma,aes(x=status,y=thickness))+
  geom_boxplot(aes(fill=status))+
  geom_violin(aes(fill=status))+
  geom_jitter(size=0.2)+
  facet_grid(status~sex)
```

Burada facet_grid() fonksiyonu kullanılmadan da boxplot ve histogram grafiği aşağıdaki gibi iki kategorik grup değişleni için bir arada oluşturulabilir. Bu durumu geom_boxplot() ve geom_violin() fonksiyonları içerisinde status değişkeni yerine cinsiyet değişkenine göre renklendirme yaparak sağlayabiliriz.

```{r}
ggplot(data=melanoma,aes(x=status,y=thickness))+
  geom_boxplot(aes(fill=sex))+
  geom_violin(aes(fill=sex))+
  geom_jitter(size=0.2)
```

Bir verinin normal dağılıma benzeyen veya yakın bir yapıda olup-olmadığını belirlemek için kullanılabilecek yapı histogram ve yoğunluk grafiklerini kullanmaktır. Bu grafikler de bir arada aşağıdaki gibi kullanılabilir. Ancak burada histogram grafiğinin y ekseninde frekanslar varken, yoğunluk grafiğinde y ekseninde yoğunluklar raporlanmaktadır. Burada uyumu yakalamak için geom_histogram() fonksiyonunda aes fonksiyonunun y argümanına ..density.. ifadesi girilir. Böylece histogramın y-ekseni de yoğunluklara dönüştürülmüş olacaktır. İlgili fonksiyonlardaki diğer argüman kullanımları öncekiler ile aynıdır.

```{r}
ggplot(data=melanoma,aes(x=thickness))+
  geom_histogram(aes(y=..density..),bins=30)+
  geom_density()
```

Burada da status değişkenine göre ayrı ayrı histogram ve yoğunluk grafikleri elde etmek için facet_grid() fonksiyonu aşağıdaki gibi kullanılabilir.

```{r}
ggplot(data=melanoma,aes(x=thickness))+
  geom_histogram(aes(y=..density..),bins=30)+
  geom_density(aes(fill=status),alpha=0.4)+
  facet_grid(.~status)
```

# Kullanılabilecek Alternatif Grafik Türleri

## Nokta Grafiği

Histogram grafiği yerine kullanılabilecek bu grafikte aslında histogramdan farklı olarak dikdörtgen yerine üst üste bindirilmiş noktalar görselleştirilmektedir. Literatürdeki grafiklerden farklılık elde etmek ve veri görselleştirme yeteneğinizi örneklendirmek istediğinizde kullanılabilir. Bu amaçla kullanılacak fonksiyon ise geom_dotplot() fonksiyonudur. Burada binwidth argümanına verilen değer noktaların büyüklüğünü belirlemekte olup, değer küçüldükçe noktalar da küçülmektedir.

```{r}
ggplot(data=melanoma,aes(x=thickness))+
  geom_dotplot(aes(fill=status),binwidth=0.4)
```

## QQ Plot Grafiği

Bu grafik verinin normal dağılıma sahip olup-olmadığını görsel olarak incelemek için kullanılır. Burada kullanılacak anahtar fonksiyon `stat_qq()` fonksiyonudur. 45 derecelik açıdan sapmalar verinin normal dağılımdan uzaklaştığını ifade etmektedir. QQ plot grafiği teorik dağılımla örnekten elde edilen deneysel dağılımı karşılaştırdığından, önceki grafiklerden farklı olarak `aes` fonksiyonunda ilgili değişken `sample` argümanına atanmıştır.

```{r}
ggplot(data=melanoma,aes(sample=thickness))+
  stat_qq()+
  stat_qq_line(col="red")
```

Grafikten verinin normal dağılmadığı rahatlıkla görülmektedir. Bu sonuç aşağıdaki gibi test edilebilir.

```{r}
ks.test(melanoma$thickness,"pnorm")
```

## Manuel şekil, renk ve büyüklük belirleme

iris verisindeki 3 sayısal değişken ve bir kategorik değişken için köpük grafiği aşağıdaki gibi oluşturulabilir.

```{r}
ggplot(data=iris,aes(x=Sepal.Length,y=Petal.Length))+
  geom_point(aes(size=Sepal.Width,color=Species,shape=Species))
```

Böylece grafiğe 4 farklı değişken (3 nicel ve 1 kategorik) yansıtılmıştır.

Grafikteki noktaların şekil, renk ve boyutlarını manuel olarak düzenlemek için ise sırasıyla `scale_shape_manual(), scale_color_manual()` ve `scale_size_manual()` fonksiyonları kullanılabilir. Ancak burada manuel olarak girilse de gözlemlerin hangi değişkene göre şekil, boyut ve rengin belirleneceğinin `geom_point()` fonksiyonunda belirtilmesi gerekmektedir. Önceki yapıdan farklı olarak burada sadece verilecek değerleri kullanıcı kesin olarak belirleme fırsatı yakalamaktadır.

```{r}
ggplot(data=iris,aes(x=Sepal.Length,y=Petal.Length))+
  geom_point(aes(size=Species,color=Species,shape=Species))+
  scale_size_manual(values=c(1,3,5))+
  scale_color_manual(values=c("red","blue","brown"))+
  scale_shape_manual(values=c(3,7,10))
```
